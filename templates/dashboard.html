{% extends 'base.html' %}
{% block content %}

<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-value">{{ total_students }}</div>
    <div class="stat-label">Total Students</div>
  </div>
  <div class="stat-card">
    <div class="stat-value">{{ total_courses }}</div>
    <div class="stat-label">Total Courses</div>
  </div>
</div>

<div class="flex-between">
  <h2 class="page-title">Student Dashboard</h2>
  <a class="btn" href="{{ url_for('add_student') }}">+ Add Student</a>
</div>

<div class="card" style="margin-bottom: 2rem;">
  <form method="GET" style="display: flex; gap: 10px;">
    <input name="search" value="{{ search }}" placeholder="Search by student name..." style="flex: 1;">
    <button class="btn">Search</button>
    {% if search %}
    <a href="{{ url_for('dashboard') }}" class="btn secondary">Clear</a>
    {% endif %}
  </form>
</div>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Age</th>
        <th>Course</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for s in students.items %}
      <tr>
        <td data-label="Name">{{ s.name }}</td>
        <td data-label="Age">{{ s.age }}</td>
        <td data-label="Course">{{ s.course.name }}</td>
        <td data-label="Actions">
          <a class="btn btn-sm secondary" href="{{ url_for('edit_student', id=s.id) }}">Edit</a>
          <a class="btn btn-sm danger" href="{{ url_for('delete_student', id=s.id) }}"
            onclick="return confirm('Are you sure you want to delete this student?')">Delete</a>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4" style="text-align: center; color: var(--text-muted);">No students found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- PAGINATION -->
<div class="pagination">
  {% if students.has_prev %}
  <a href="{{ url_for('dashboard', page=students.prev_num, search=search) }}" class="btn secondary">Previous</a>
  {% endif %}

  <span>Page {{ students.page }} of {{ students.pages }}</span>

  {% if students.has_next %}
  <a href="{{ url_for('dashboard', page=students.next_num, search=search) }}" class="btn secondary">Next</a>
  {% endif %}
</div>

{% endblock %}